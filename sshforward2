#!/bin/bash

check_command() {
    type $1 &> /dev/null || { echo "$1 not found." >&1; return 1; }
}

check_command expect || exit 127
check_command python || exit 127

if [ $# -eq 0 ]; then
    echo -e "provide services in SSH forwarding tunnel"
	echo -e "Usage:\n\t$0 <app name> <vault file>"
	echo -e "App name:"
	echo -e  "\topenstack"
	echo -e  "\tredmine"
	exit 0
fi

app=$1
shift

case "$app" in
    openstack )
        ;;
    redmine )
        ;;
    -- ) shift; break ;;
    * ) echo -e "error input"; exit 127;;
esac

[ $# -eq 0 ] && { /bin/bash $app; exit 0; }

. functions
# test
get_vault_file $1 &> /dev/null || exit 1

# vault file located in ~/.vault/
vault=$(basename $1)

exec /bin/bash $app $vault &

